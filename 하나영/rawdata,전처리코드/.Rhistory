plot(theta,dbeta(theta,a+x, b+n-x),type="l")
#2(2)
par(mfrow=c(2,2))
plot(theta, prior.theta, type="l", sub="(a) prior:pi(theta)")
plot(theta, likhd.theta, type="l",sub="(b) likelihood : f(x|theta)")
abline(v=x/n,lty=2)
plot(theta, joint.xtheta, type="l", sub="(c) prior x likelihood : pi (theta)x f(x|theta)")
abline(v=(a+x-1)/(a+b+n-2), lty=2)
abline(v=(a+x-1)/ (a+b+n-2), lty=2)
par(mfrow=c(1,1))
plot(theta, post.theta, type="l", sub="(d) poeterior : pi(theta|x)")
#2(2)
par(mfrow=c(2,2))
plot(theta, prior.theta, type="l", sub="(a) prior:pi(theta)")
plot(theta, likhd.theta, type="l",sub="(b) likelihood : f(x|theta)")
plot(theta, joint.xtheta, type="l", sub="(c) prior x likelihood : pi (theta)x f(x|theta)")
abline(v=(a+x-1)/(a+b+n-2), lty=2)
abline(v=x/n,lty=2)
plot(theta, post.theta, type="l", sub="(d) poeterior : pi(theta|x)")
abline(v=(a+x-1)/ (a+b+n-2), lty=2)
par(mfrow=c(1,1))
plot(theta,dbeta(theta,a+x, b+n-x),type="l")
#2(3)theta random sample
theta = rbeta(2000,a+x,b+n-x)
hist(theta, prob=T)
lines(density(theta))
mean.theta=mean(theta)
abline(v=mean.theta, lty=2)
quantile(theta,c(0.025, 0.975))
qbeta(c(0.025,0.975),a+x, b+n-x)
plot(theta,dbeta(theta,a+x, b+n-x),type="l")
#2(3)theta random sample
theta = rbeta(2000,a+x,b+n-x)
hist(theta, prob=T)
lines(density(theta))
mean.theta=mean(theta)
abline(v=mean.theta, lty=2)
quantile(theta,c(0.025, 0.975))
qbeta(c(0.025,0.975),a+x, b+n-x)
#2(4) #prior_eta
par(mfrow=c(1,1))
pr.theta=rbeta(10000,a,b)
pr.eta=log(pr.theta/(1-pr.theta))
hist(pr.eta,prob=T)
#post_eta
theta=rbeta(10000,a+x,b+n-x)
eta=log(theta/(1-theta))
hist(eta,prob=T)
lines(density(pr.eta))
abline(v=mean(pr.eta),lty=2)
lines(density(eta),col="red")
abline(v=mean(eta),lty=2,col="red")
theta=seq(0,1,length=1000)
theta = rbeta(2000,a+x,b+n-x)
prob=theta/sum(theta)
HPD=HPDgrid(prob,0.95)
qbeta(c(0.025,0.975),a+x, b+n-x)
a=b=1
n1=18 ;x1=12; n2=10; x2=8
theta1=rbeta(10000,a+x1,b+n1-x1)
theta2=rbeta(10000,a+x2,b+n2-x2)
eta=log(theta1/theta2)
xi=log((theta1/(1-theta1))/(theta2/(1-theta2)))
par(mfrow=c(1,2))
plot(density(eta),type="l",xlab="로그비",ylab="posterior density",main="")
HPD=HPDsample(eta)
abline(v=HPD,lty=2)
a=b=1
n1=18 ;x1=12; n2=10; x2=8
theta1=rbeta(10000,a+x1,b+n1-x1)
theta2=rbeta(10000,a+x2,b+n2-x2)
eta=log(theta1/theta2)
xi=log((theta1/(1-theta1))/(theta2/(1-theta2)))
HPDsmaple=function(theta,level=0.95) {
N=length(theta)
theta.sort=sort(theta)
M=ceiling(N*level)
nCI=N-M
CI.width=rep(0,nCI)
for(i in 1:nCI)CI.width[i]=theta.sort[i+M]-theta.sort[i]
index=which.min(CI.width)
HPD=c(theta.sort[index],theta.sort[index+M])
return(HPD)
}
par(mfrow=c(1,2))
HPD=HPDsample(xi)
text(mean(xi),0.06,"95% HPD interval")
abline(v=HPD,lty=2)
plot(density(xi),type="l",xlab="로그오즈비",ylab="posterior density",main="")
HPD=HPDsample(eta)
text(mean(eta),0.3,"95% HPD interval")
plot(density(eta),type="l",xlab="로그비",ylab="posterior density",main="")
abline(v=HPD,lty=2)
text(mean(xi),0.06,"95% HPD interval")
mean(eta)
plot(density(eta),type="l",xlab="로그비",ylab="posterior density",main="")
abline(v=HPD,lty=2)
text(mean(eta),0.3,"95% HPD interval")
text(mean(eta),0.73,"95% HPD interval")
text(mean(eta),0.9,"95% HPD interval")
text(mean(eta),0.3,"95% HPD interval")
HPD=HPDsample(xi)
plot(density(xi),type="l",xlab="로그오즈비",ylab="posterior density",main="")
text(mean(xi),0.06,"95% HPD interval")
rm(list=ls())
getwd()
setwd("C:\\Users\\user\\Desktop\\Project_apartment")
dir()
dat = read.csv("단지별 매매$전세값(수정).csv")
dat = read.csv("단지별 매매&전세값(수정).csv")
View(dat)
str(dat)
loc = dat$구시구
majeon = grep('마전동',loc)
loc = dat$구시
majeon = grep('마전동',loc)
loc = dat$구시군
majeon = grep('마전동',loc)
dangha = grep('당하동', loc)
wondang = grep('원당동', loc)
bulo = grep('불로동', loc)
songdo=grep('송도동', loc)
eunseo=grep(‘운서동’, loc)
eunnam=grep(‘운남동’, loc)
eunbook=grep(‘운북동’, loc)
jungsan=grep(‘중산동’, loc)
dohwa=grep(‘도화동’,loc)
soongee=grep(‘숭의동’,loc)
chungla=grep(‘청라동’, loc)
suknam=grep(‘석남동’,loc)
gaza=grep(‘가좌동’,loc)
gajung=grep(‘가정동’,loc)
gumdan=grep(‘검단동’,loc)
bupyeong=grep(‘부평동’,loc)
hwasu = grep('화수동', loc)
songlim=grep('송림동',loc)
dep=c(majeon,dangha,wondang,bulo,songdo,eunseo,eunnam,eunbook,jungsan,dohwa,soongee,chungla,suknam,gaza,gajung,gumdan,bupyeong,hwasu,songlim)
loc = dat$구시군
majeon = grep('마전동',loc)
loc = dat$구시군
loc
#View(dat)
#str(dat)
dat$읍면동 = as.character(dat$읍면동)
loc = dat$읍면동
loc
majeon = grep('마전동',loc)
dangha = grep('당하동', loc)
wondang = grep('원당동', loc)
bulo = grep('불로동', loc)
songdo=grep('송도동', loc)
eunseo=grep(‘운서동’, loc)
eunnam=grep(‘운남동’, loc)
eunbook=grep(‘운북동’, loc)
dohwa=grep(‘도화동’,loc)
soongee=grep(‘숭의동’,loc)
chungla=grep(‘청라동’, loc)
suknam=grep(‘석남동’,loc)
gaza=grep(‘가좌동’,loc)
jungsan=grep(‘중산동’, loc)
gajung=grep(‘가정동’,loc)
gumdan=grep(‘검단동’,loc)
bupyeong=grep(‘부평동’,loc)
hwasu = grep('화수동', loc)
hwasu = grep('화수동', loc)
songlim=grep('송림동',loc)
eunseo=grep('운서동', loc)
eunnam=grep('운남동', loc)
eunbook=grep('운북동', loc)
jungsan=grep('중산동', loc)
dohwa=grep('도화동',loc)
chungla=grep('청라동', loc)
soongee=grep('숭의동',loc)
suknam=grep('석남동',loc)
gaza=grep('가좌동',loc)
gajung=grep('가정동',loc)
gumdan=grep('검단동',loc)
bupyeong=grep('부평동',loc)
songlim=grep('송림동',loc)
dep=c(majeon,dangha,wondang,bulo,songdo,eunseo,eunnam,eunbook,jungsan,dohwa,soongee,chungla,suknam,gaza,gajung,gumdan,bupyeong,hwasu,songlim)
hwasu = grep('화수동', loc)
dep=c("majeon","dangha","wondang","bulo","songdo","eunseo",
"eunnam","eunbook","jungsan","dohwa","soongee","chungla",
"suknam", "gaza","gajung","gumdan","bupyeong","hwasu","songlim")
dat[dep,]$개발호재.유무 = “유”
dat[majeon,]$개발호재.유무 = "유"
setwd("C:\\Users\\user\\Desktop\\Project_apartment")
dir()
dat = read.csv("단지별 매매&전세값(수정).csv")
#View(dat)
#str(dat)
dat$읍면동 = as.character(dat$읍면동)
loc = dat$읍면동
loc
majeon = grep('마전동',loc)
dangha = grep('당하동', loc)
wondang = grep('원당동', loc)
bulo = grep('불로동', loc)
songdo=grep('송도동', loc)
eunseo=grep('운서동', loc)
eunnam=grep('운남동', loc)
eunbook=grep('운북동', loc)
jungsan=grep('중산동', loc)
dohwa=grep('도화동',loc)
soongee=grep('숭의동',loc)
chungla=grep('청라동', loc)
suknam=grep('석남동',loc)
gaza=grep('가좌동',loc)
gajung=grep('가정동',loc)
bupyeong=grep('부평동',loc)
hwasu = grep('화수동', loc)
songlim=grep('송림동',loc)
dat[dep,]$개발호재.유무 = “유”
dat[majeon,]$개발호재.유무 = "유"
dep=c("majeon","dangha","wondang","bulo","songdo","eunseo",
"eunnam","eunbook","jungsan","dohwa","soongee","chungla",
"suknam", "gaza","gajung","gumdan","bupyeong","hwasu","songlim")
gumdan=grep('검단동',loc)
dat[dep, ]$개발호재유무 = “유”
dat[majeon,]$개발호재.유무 = "유"
songlim
dep
dep=c(majeon,dangha)
dep
#,"wondang","bulo","songdo","eunseo",
#     "eunnam","eunbook","jungsan","dohwa","soongee","chungla",
#     "suknam", "gaza","gajung","gumdan","bupyeong","hwasu","songlim")
dat[dep, ]$개발호재유무 = “유”
dat[majeon,]$개발호재.유무 = "유"
#,"wondang","bulo","songdo","eunseo",
#     "eunnam","eunbook","jungsan","dohwa","soongee","chungla",
#     "suknam", "gaza","gajung","gumdan","bupyeong","hwasu","songlim")
dat[dep, ]$개발호재유무 = “유”
dat[majeon,]$개발호재.유무 = "유"
#,"wondang","bulo","songdo","eunseo",
#     "eunnam","eunbook","jungsan","dohwa","soongee","chungla",
#     "suknam", "gaza","gajung","gumdan","bupyeong","hwasu","songlim")
dat[dep, ]$개발호재유무 = “유”
dat[majeon,]$개발호재유무 = "유"
majeon = grep('마전동',loc)
#,"wondang","bulo","songdo","eunseo",
#     "eunnam","eunbook","jungsan","dohwa","soongee","chungla",
#     "suknam", "gaza","gajung","gumdan","bupyeong","hwasu","songlim")
dat[dep, ]$개발호재유무 = “유”
dat[majeon,]$개발호재유무 = "유"
setwd("C:\\Users\\user\\Desktop\\Project_apartment")
dir()
dat = read.csv("단지별 매매&전세값(수정).csv")
#View(dat)
#str(dat)
dat$읍면동 = as.character(dat$읍면동)
loc = dat$읍면동
loc
majeon = grep('마전동',loc)
dangha = grep('당하동', loc)
wondang = grep('원당동', loc)
bulo = grep('불로동', loc)
songdo=grep('송도동', loc)
eunseo=grep('운서동', loc)
eunnam=grep('운남동', loc)
eunbook=grep('운북동', loc)
jungsan=grep('중산동', loc)
soongee=grep('숭의동',loc)
chungla=grep('청라동', loc)
suknam=grep('석남동',loc)
gaza=grep('가좌동',loc)
dohwa=grep('도화동',loc)
gajung=grep('가정동',loc)
gumdan=grep('검단동',loc)
bupyeong=grep('부평동',loc)
hwasu = grep('화수동', loc)
songlim=grep('송림동',loc)
#dep=c(majeon,dangha)
#,"wondang","bulo","songdo","eunseo",
#     "eunnam","eunbook","jungsan","dohwa","soongee","chungla",
#     "suknam", "gaza","gajung","gumdan","bupyeong","hwasu","songlim")
dat[dep, ]$개발호재유무 = “유”
dat[majeon,]$개발호재유무 = "유"
1
#dep=c(majeon,dangha)
#,"wondang","bulo","songdo","eunseo",
#     "eunnam","eunbook","jungsan","dohwa","soongee","chungla",
#     "suknam", "gaza","gajung","gumdan","bupyeong","hwasu","songlim")
dat[1, ]$개발호재유무 = “유”
dat[majeon,]$개발호재유무 = "유"
dat
#dep=c(majeon,dangha)
#,"wondang","bulo","songdo","eunseo",
#     "eunnam","eunbook","jungsan","dohwa","soongee","chungla",
#     "suknam", "gaza","gajung","gumdan","bupyeong","hwasu","songlim")
dat[1, ]$개발호재유무 = “유”
dir(dat)
str(dat)
loc = dat$읍면동
loc
#dep=c(majeon,dangha)
#,"wondang","bulo","songdo","eunseo",
#     "eunnam","eunbook","jungsan","dohwa","soongee","chungla",
#     "suknam", "gaza","gajung","gumdan","bupyeong","hwasu","songlim")
dat[1, ]$개발호재유무 = “유”
dim(dat)
dat[majeon,]$개발호재유무 = "유"
majeon
dat[majeon,]$개발호재유무 = "유"
dat[majeon,]$개발호재유무
dat[majeon,]
majeon = grep('마전동',loc)
dangha = grep('당하동', loc)
wondang = grep('원당동', loc)
bulo = grep('불로동', loc)
songdo=grep('송도동', loc)
eunseo=grep('운서동', loc)
eunnam=grep('운남동', loc)
jungsan=grep('중산동', loc)
dohwa=grep('도화동',loc)
chungla=grep('청라동', loc)
gaza=grep('가좌동',loc)
gajung=grep('가정동',loc)
suknam=grep('석남동',loc)
soongee=grep('숭의동',loc)
eunbook=grep('운북동', loc)
bupyeong=grep('부평동',loc)
hwasu = grep('화수동', loc)
gumdan=grep('검단동',loc)
songlim=grep('송림동',loc)
dat[majeon,]$개발호재유무
dat[majeon,]
majeon
majeon = grep('마전동',loc)
majeon
#View(dat)
#str(dat)
dat$읍면동 = as.character(dat$읍면동)
loc = dat$읍면동
loc
majeon = grep('마전동',loc)
majeon
majeon = grep('마전동',loc)
majeon
setwd("C:\\Users\\user\\Desktop\\Project_apartment")
dir()
dat = read.csv("단지별 매매&전세값(수정).csv")
#View(dat)
#str(dat)
dat$읍면동 = as.character(dat$읍면동)
loc = dat$읍면동
loc
majeon = grep('마전동',loc)
majeon
rm(list=ls())
getwd()
setwd("C:\\Users\\user\\Desktop\\Project_apartment")
dir()
dat = read.csv("단지별 매매&전세값(수정).csv")
#dir() 파일명
dat = read.csv("단지별 매매&전세값(수정).csv")
#View(dat)
#str(dat)
dat$읍면동 = as.character(dat$읍면동)
loc = dat$읍면동
#loc
majeon = grep('마전동',loc)
dangha = grep('당하동', loc)
wondang = grep('원당동', loc)
bulo = grep('불로동', loc)
majeon
#View(dat)
#str(dat)
dat$읍면동 = as.character(dat$읍면동)
loc = dat$읍면동
#loc
majeon = grep('마전동',loc)
loc = dat$읍면동
#loc
majeon = grep('마전동',loc)
majeon
loc = dat$읍면동
#loc
majeon = grep(마전동,loc)
loc = dat$읍면동
#loc
str(마전동)
loc = dat$읍면동
#loc
majeon = grep('마전동' ,loc)
loc = dat$읍면동
#loc
?grep
dangha = grep('당하동', loc)
dangha
loc = dat$읍면동
#loc
dangha = grep('당하동', loc)
bulo = grep('불로대곡동' , loc)
songdo=grep('송도동', loc)
eunseo=grep('운서동', loc)
wondang = grep('원당동', loc)
youngjong=grep('영종동',loc)
dohwa=grep('도화동',loc)
chungla=grep('청라동', loc)
soongee=grep('숭의동',loc)
suknam=grep('석남동',loc)
gaza=grep('가좌동',loc)
gajung=grep('가정동',loc)
gumdan=grep('검단동',loc)
bupyeong=grep('부평동',loc)
hwasu = grep('화수동', loc)
songlim=grep('송림동',loc)
dep=c(,"dangha",
"wondang","bulo","songdo","eunseo",
"youngjong","dohwa","soongee","chungla",
"suknam", "gaza","gajung","gumdan","bupyeong","hwasu","songlim")
dat[dep, ]$개발호재유무 = “유”
dim(dat)
dep=c(,"dangha","wondang","bulo","songdo","eunseo",
"youngjong","dohwa","soongee","chungla",
"suknam", "gaza","gajung","gumdan","bupyeong","hwasu","songlim")
dat[dep, ]$개발호재유무 = “유”
dim(dat)
dep=c("dangha","wondang","bulo","songdo","eunseo",
"youngjong","dohwa","soongee","chungla",
"suknam", "gaza","gajung","gumdan","bupyeong","hwasu","songlim")
dat[dep, ]$개발호재유무 = “유”
dim(dat)
dat[dep, ]$개발호재유무 = “유”
dat[danha,]$개발호재.유무 = "유"
dat[dep, ]$개발호재유무 = “유”
dat[danha,]$개발호재.유무 = "유"
dat[dep, ]$개발호재유무 = “유”
dat[dangha,]$개발호재.유무 = "유"
dat[dep, ]$개발호재유무 = “유”
dat[dangha,]$개발호재유무 = "유"
dat[wondang,]$개발호재유무 = "유"
dat[youngjong,]$개발호재유무 = "유"
dat[dangha,]$개발호재유무 = "유"
dat[wondang,]$개발호재유무 = "유"
dat[songdo,]$개발호재유무 = "유"
dat[bulo,]$개발호재유무 = "유"
dat[hwasu,]$개발호재유무 = "유"
dat[songlim,]$개발호재유무 = "유"
dat[eunseo,]$개발호재유무 = "유"
dat[youngjong,]$개발호재유무 = "유"
dat[chungla,]$개발호재유무 = "유"
dat[suknam,]$개발호재유무 = "유"
dat[dohwa,]$개발호재유무 = "유"
dat[gaza,]$개발호재유무 = "유"
dat[gumdan,]$개발호재유무 = "유"
dat[gajung,]$개발호재유무 = "유"
dat[soongee,]$개발호재유무 = "유"
dat[bupyeong,]$개발호재유무 = "유"
dat[hwasu,]$개발호재유무 = "유"
dat[songlim,]$개발호재유무 = "유"
View(dat)
write.csv(dat,'개발호재(최종).csv')
write.csv(dat,'단지별 매매&전세값(+개발호재).csv')
write.csv(dat,'단지별 매매&전세값+개발호재.csv')
setwd("C:\\Users\\user\\Desktop\\Project_apartment")
setwd("C:\\Users\\user\\Desktop\\Project_apartment)
dat<-read.csv("혼인데이터.csv")
View(dat)
for(i in 2:dim(dat)[2]){
dat[,i]=as.numeric(as.character(dat[,i]))
}
dat[10,2:25]=dat[4,2:25]
write.csv("Marriage.csv")
setwd("C:\\Users\\user\\Desktop\\Project_apartment)
dat<-read.csv("혼인데이터.csv")
View(dat)
for(i in 2:dim(dat)[2]){
dat[,i]=as.numeric(as.character(dat[,i]))
}
dat[10,2:25]=dat[4,2:25]
write.csv("Marriage.csv")
setwd("C:\\Users\\user\\Desktop\\Project_apartment\\하나영)
dat<-read.csv("혼인데이터.csv")
View(dat)
C:\Users\user\Desktop\Project_apartment\하나영
for(i in 2:dim(dat)[2]){
dat[,i]=as.numeric(as.character(dat[,i]))
}
dat[10,2:25]=dat[4,2:25]
write.csv("Marriage.csv")
rm(list=ls())
setwd("C:\\Users\\user\\Desktop\\Project_apartment\\하나영")
dat<-read.csv("혼인데이터.csv")
for(i in 2:dim(dat)[2]){
dat[,i]=as.numeric(as.character(dat[,i]))
}
for(i in 2:dim(dat)[2]){
dat[,i]=as.numeric(as.character(dat[,i]))
}
dat[10,2:25]=dat[4,2:25]
dat
write.csv("Marriage.csv")
write.csv("Marriage.csv")
dat[10,2:25]=dat[4,2:25]
dat
View(dat
View(dat)
View(dat)
dat[4,26:37]=dat[10,26:37]
dat[10,2:25]=dat[4,2:25]
View(dat)
dat[-4,]
View(dat)
write.csv("Marriage.csv")
write.csv(dat,"Marriage.csv")
setwd("C:\\Users\\user\\Desktop\\Project_apartment\\하나영\\rawdata")
dat<- read.csv("지가변동률(2016.1~2018.12).csv")
head(dat)
#install.packages("dplyr")
library(dplyr)
