#2(4) #prior_eta
par(mfrow=c(1,2))
pr.theta=rbeta(10000,a,b)
pr.eta=log(pr.theta/(1-pr.theta))
hist(pr.eta,prob=T)
lines(density(pr.eta))
abline(v=mean(pr.eta),lty=2)
#post_eta
theta=rbeta(10000,a+x,b+n-x)
eta=log(theta/(1-theta))
hist(eta,prob=T)
lines(density(eta))
abline(v=mean(eta),lty=2)
mean(pr.eta)
mean(eta)
#2(4) #prior_eta
par(mfrow=c(1,2))
pr.theta=rbeta(10000,a,b)
hist(pr.eta,prob=T)
pr.eta=log(pr.theta/(1-pr.theta))
lines(density(pr.eta))
abline(v=mean(pr.eta),lty=2)
lines(density(eta),col="red")
#2(4) #prior_eta
par(mfrow=c(1,1))
pr.theta=rbeta(10000,a,b)
pr.eta=log(pr.theta/(1-pr.theta))
hist(pr.eta,prob=T)
lines(density(pr.eta))
abline(v=mean(pr.eta),lty=2)
lines(density(eta),col="red")
abline(v=mean(eta),lty=2,col="red")
#2(4) #prior_eta
par(mfrow=c(1,1))
#post_eta
theta=rbeta(10000,a+x,b+n-x)
eta=log(theta/(1-theta))
hist(eta,prob=T)
lines(density(pr.eta))
abline(v=mean(pr.eta),lty=2)
lines(density(eta),col="red")
abline(v=mean(eta),lty=2,col="red")
mean(pr.eta
mean(eta)
abline(v=mean(eta),lty=2,col="red")
ean(eta)
mean(pr.eta)
mean(eta)
#2(4) #prior_eta
par(mfrow=c(1,1))
pr.theta=rbeta(10000,a,b)
pr.eta=log(pr.theta/(1-pr.theta))
#post_eta
theta=rbeta(10000,a+x,b+n-x)
eta=log(theta/(1-theta))
hist(eta,prob=T)
abline(v=mean(pr.eta),lty=2)
lines(density(pr.eta))
lines(density(eta),col="red")
abline(v=mean(eta),lty=2,col="red")
mean(eta)
mean(pr.eta
)
hist(pr.eta,prob=T)
lines(density(pr.eta))
abline(v=mean(pr.eta),lty=2)
#post_eta
theta=rbeta(10000,a+x,b+n-x)
eta=log(theta/(1-theta))
hist(eta,prob=T)
lines(density(pr.eta))
abline(v=mean(pr.eta),lty=2)
abline(v=mean(eta),lty=2,col="red")
lines(density(eta),col="red")
qbeta(c(0.025,0.975),a+x, b+n-x)
prob=theta/sum(theta)
HPD=HPDgrid(prob,0.95)
theta=seq(0,1,length=1000)
theta = rbeta(2000,a+x,b+n-x)
prob=theta/sum(theta)
HPD=HPDgrid(prob,0.95)
HPD.grid=c(min(theta))
HPD.grid=c(min(theta[HPD$index]),max(theta[HPD$index]))
HPD.grid
HPD=HPDgrid(prob,0.95)
?HPDgrid
install.packages(HPD)
install.packages(HPDgrid)
#6
a=b=1
n1=20; x1=10; n2=20; x1=14
theta1=rbeta(10000,a+x1,b+n1-x1)
theta2=rbeta(10000,a+x2,b+n2-x2)
eta=log(theta1/theta2)
xi=log((theta1/(1-theta1))/(theta2/(1-theta2)))
par(mfrow=c(1,2))
HPD=HPDsample(eta)
?HPD
install.packages("HDInterval")
library("HDinterval")
install.packages("HDInterval")
library("HDinterval")
library("HDInterval")
HPD=HPDsample(eta)
HPD=HPDsample(eta)
library("BayesTwin")
install.packages("BayesTwin")
library("BayesTwin")
HPD=HPDsample(eta)
library("BayesTwin")
HPD=HPDsample(eta)
#2(1)
# theta~Beta(a,b)
a=11/25; b=44/25
# x|theta - B(n.theta)
n=10; x=2
# a discretization pf the possible theta values
theta = seq(0,1,length=50)
prior.theta = dbeta(theta,a,b)
#prob of data\theta(likelihood)
likhd.theta = dbinom(x,n,theta)
#joint prob of data $ theta
joint.xtheta = prior.theta*likhd.theta
#posterior of theta
post.theta = dbeta(theta, a+x, b+n-x)
#2(2)
par(mfrow=c(2,2))
plot(theta, prior.theta, type="l", sub="(a) prior:pi(theta)")
plot(theta, likhd.theta, type="l",sub="(b) likelihood : f(x|theta)")
abline(v=x/n,lty=2)
plot(theta, joint.xtheta, type="l", sub="(c) prior x likelihood : pi (theta)x f(x|theta)")
abline(v=(a+x-1)/(a+b+n-2), lty=2)
plot(theta, post.theta, type="l", sub="(d) poeterior : pi(theta|x)")
abline(v=(a+x-1)/ (a+b+n-2), lty=2)
par(mfrow=c(1,1))
plot(theta,dbeta(theta,a+x, b+n-x),type="l")
#2(2)
par(mfrow=c(2,2))
plot(theta, prior.theta, type="l", sub="(a) prior:pi(theta)")
plot(theta, likhd.theta, type="l",sub="(b) likelihood : f(x|theta)")
abline(v=x/n,lty=2)
plot(theta, joint.xtheta, type="l", sub="(c) prior x likelihood : pi (theta)x f(x|theta)")
abline(v=(a+x-1)/(a+b+n-2), lty=2)
abline(v=(a+x-1)/ (a+b+n-2), lty=2)
par(mfrow=c(1,1))
plot(theta, post.theta, type="l", sub="(d) poeterior : pi(theta|x)")
#2(2)
par(mfrow=c(2,2))
plot(theta, prior.theta, type="l", sub="(a) prior:pi(theta)")
plot(theta, likhd.theta, type="l",sub="(b) likelihood : f(x|theta)")
plot(theta, joint.xtheta, type="l", sub="(c) prior x likelihood : pi (theta)x f(x|theta)")
abline(v=(a+x-1)/(a+b+n-2), lty=2)
abline(v=x/n,lty=2)
plot(theta, post.theta, type="l", sub="(d) poeterior : pi(theta|x)")
abline(v=(a+x-1)/ (a+b+n-2), lty=2)
par(mfrow=c(1,1))
plot(theta,dbeta(theta,a+x, b+n-x),type="l")
#2(3)theta random sample
theta = rbeta(2000,a+x,b+n-x)
hist(theta, prob=T)
lines(density(theta))
mean.theta=mean(theta)
abline(v=mean.theta, lty=2)
quantile(theta,c(0.025, 0.975))
qbeta(c(0.025,0.975),a+x, b+n-x)
plot(theta,dbeta(theta,a+x, b+n-x),type="l")
#2(3)theta random sample
theta = rbeta(2000,a+x,b+n-x)
hist(theta, prob=T)
lines(density(theta))
mean.theta=mean(theta)
abline(v=mean.theta, lty=2)
quantile(theta,c(0.025, 0.975))
qbeta(c(0.025,0.975),a+x, b+n-x)
#2(4) #prior_eta
par(mfrow=c(1,1))
pr.theta=rbeta(10000,a,b)
pr.eta=log(pr.theta/(1-pr.theta))
hist(pr.eta,prob=T)
#post_eta
theta=rbeta(10000,a+x,b+n-x)
eta=log(theta/(1-theta))
hist(eta,prob=T)
lines(density(pr.eta))
abline(v=mean(pr.eta),lty=2)
lines(density(eta),col="red")
abline(v=mean(eta),lty=2,col="red")
theta=seq(0,1,length=1000)
theta = rbeta(2000,a+x,b+n-x)
prob=theta/sum(theta)
HPD=HPDgrid(prob,0.95)
qbeta(c(0.025,0.975),a+x, b+n-x)
a=b=1
n1=18 ;x1=12; n2=10; x2=8
theta1=rbeta(10000,a+x1,b+n1-x1)
theta2=rbeta(10000,a+x2,b+n2-x2)
eta=log(theta1/theta2)
xi=log((theta1/(1-theta1))/(theta2/(1-theta2)))
par(mfrow=c(1,2))
plot(density(eta),type="l",xlab="로그비",ylab="posterior density",main="")
HPD=HPDsample(eta)
abline(v=HPD,lty=2)
a=b=1
n1=18 ;x1=12; n2=10; x2=8
theta1=rbeta(10000,a+x1,b+n1-x1)
theta2=rbeta(10000,a+x2,b+n2-x2)
eta=log(theta1/theta2)
xi=log((theta1/(1-theta1))/(theta2/(1-theta2)))
HPDsmaple=function(theta,level=0.95) {
N=length(theta)
theta.sort=sort(theta)
M=ceiling(N*level)
nCI=N-M
CI.width=rep(0,nCI)
for(i in 1:nCI)CI.width[i]=theta.sort[i+M]-theta.sort[i]
index=which.min(CI.width)
HPD=c(theta.sort[index],theta.sort[index+M])
return(HPD)
}
par(mfrow=c(1,2))
HPD=HPDsample(xi)
text(mean(xi),0.06,"95% HPD interval")
abline(v=HPD,lty=2)
plot(density(xi),type="l",xlab="로그오즈비",ylab="posterior density",main="")
HPD=HPDsample(eta)
text(mean(eta),0.3,"95% HPD interval")
plot(density(eta),type="l",xlab="로그비",ylab="posterior density",main="")
abline(v=HPD,lty=2)
text(mean(xi),0.06,"95% HPD interval")
mean(eta)
plot(density(eta),type="l",xlab="로그비",ylab="posterior density",main="")
abline(v=HPD,lty=2)
text(mean(eta),0.3,"95% HPD interval")
text(mean(eta),0.73,"95% HPD interval")
text(mean(eta),0.9,"95% HPD interval")
text(mean(eta),0.3,"95% HPD interval")
HPD=HPDsample(xi)
plot(density(xi),type="l",xlab="로그오즈비",ylab="posterior density",main="")
text(mean(xi),0.06,"95% HPD interval")
setwd(C:\\Users\\user\\Desktop\\Project_apartment\\시계열 데이터\\"Marriage")
setwd("C:\\Users\\user\\Desktop\\Project_apartment\\시계열 데이터\\Marriage")
setwd("C:\\Users\\user\\Desktop\\Project_apartment\\시계열 데이터\\Marriage+평균")
getwd()
setwd("C:\\Users\\user\\Desktop\\Project_apartment\\시계열 데이터\\Marriage+평균")
setwd("C:\\Users\\user\\Desktop\\Project_apartment\\시계열 데이터")
dat<-read.csv("Marriage+평균")
dat<-read.csv("Marriage + 평균")
setwd("C:\\Users\\user\\Desktop\\Project_apartment\\시계열 데이터")
dat<-read.csv("Marriage")
dat<-read.csv("Marriage.csv")
head(dat)
dat$Average
MA<-dat$Average
dat2<-read.csv("기준금리")
dat2<-read.csv("기준금리.csv")
dat2
dat2<-read.csv("기준금리.csv")
dat2
dat2<-read.csv("기준금리.csv",head=F)
dat2
dat2$V1
x<-dat2$V3
y<-dat2$V1
plot(y,x)
plot(x,y)
x<-dat2$V1
y<-dat2$V3
plot(x,y)
?plot
plot(x,y,xlab=c(1999:2018))
plot(x,y,xlim=c(1999,2018))
plot(x,y,xlim=c(1999:2018))
plot(x,y,xlim=c(1999,2018))
plot(x,y,xlim=c(1999,2018),xlab="년도",ylab="기준금리")
#####################333333333333333333333333333333333
Apt<-read.csv("단지별 매매&전세값+개발호재")
#####################333333333333333333333333333333333
Apt<-read.csv("단지별 매매&전세값+개발호재.csv")
Mdat<-read.csv("Marriage.csv")
MA<-dat$Average
#####################333333333333333333333333333333333
Apt<-read.csv("단지별 매매&전세값+개발호재.csv")
setwd("C:\\Users\\user\\Desktop\\Project_apartment\\시계열 데이터")
#####################333333333333333333333333333333333
Apt<-read.csv("단지별 매매&전세값+개발호재.csv")
#####################333333333333333333333333333333333
Apt<-read.csv("단지별 매매&전세값+개발호재.csv")
#####################333333333333333333333333333333333
Apt<-read.csv("단지별 매매&전세값+개발호재.csv")
#####################333333333333333333333333333333333
Adat<-read.csv("단지별 매매&전세값+개발호재.csv")
head(Adat)
y<-Adat$매매평균..당가.만원.
y<-Adat$매매평균..당가.만원.
#####################333333333333333333333333333333333
Adat<-read.csv("단지별 매매&전세값+개발호재.csv",head=T)
head(Adat)
y<-Adat$매매평균..당가.만원.
Mdat<-read.csv("Marriage.csv")
MA<-dat$Average
plot(MA,y)
setwd("C:\\Users\\user\\Desktop\\Project_apartment\\정동호")
#dir() 파일명
dat = read.csv("단지별 변수(수정).csv")
#dir() 파일명
dat = read.csv("단지별변수(수정).csv")
#View(dat)
#str(dat)
dat$읍면동 = as.character(dat$읍면동)
loc = dat$읍면동
#loc
dangha = grep('당하동', loc)
wondang = grep('원당동', loc)
bulo = grep('불로대곡동' , loc)
eunseo=grep('운서동', loc)
youngjong=grep('영종동',loc)
dohwa=grep('도화동',loc)
soongee=grep('숭의동',loc)
chungla=grep('청라동', loc)
suknam=grep('석남동',loc)
gaza=grep('가좌동',loc)
gajung=grep('가정동',loc)
gumdan=grep('검단동',loc)
bupyeong=grep('부평동',loc)
songlim=grep('송림동',loc)
dep=c("dangha","wondang","bulo","songdo","eunseo",
"youngjong","dohwa","soongee","chungla",
"suknam", "gaza","gajung","gumdan","bupyeong","hwasu","songlim")
hwasu = grep('화수동', loc)
songdo=grep('송도동', loc)
dat[dep, ]$개발호재유무 = 1
dat[dangha,]$개발호재유무 = 1
dat[dangha,]$개발호재유무 = " 1 "
dat[dangha,]$개발호재유무 = " 1 "
dat[dangha,]$개발호재유무 = " 1 "
setwd("C:\\Users\\user\\Desktop\\Project_apartment\\정동호")
#dir() 파일명
dat = read.csv("단지별변수(수정).csv")
#View(dat)
#str(dat)
dat$읍면동 = as.character(dat$읍면동)
loc = dat$읍면동
#loc
dangha = grep('당하동', loc)
wondang = grep('원당동', loc)
bulo = grep('불로대곡동' , loc)
songdo=grep('송도동', loc)
youngjong=grep('영종동',loc)
dohwa=grep('도화동',loc)
soongee=grep('숭의동',loc)
chungla=grep('청라동', loc)
eunseo=grep('운서동', loc)
suknam=grep('석남동',loc)
gaza=grep('가좌동',loc)
gajung=grep('가정동',loc)
gumdan=grep('검단동',loc)
bupyeong=grep('부평동',loc)
hwasu = grep('화수동', loc)
songlim=grep('송림동',loc)
dep=c("dangha","wondang","bulo","songdo","eunseo",
"youngjong","dohwa","soongee","chungla",
"suknam", "gaza","gajung","gumdan","bupyeong","hwasu","songlim")
dat[dep, ]$개발호재유무 = 1
head(dat)
view(dat)
View(dat)
dat[dep, ]$개발호재유무 = "1"
View(dat)
write.csv(dat,'단지별변수(추가).csv')
setwd("C:\\Users\\user\\Desktop\\Project_apartment\\정동호")
#dir() 파일명
dat = read.csv("단지별변수(수정).csv")
#View(dat)
#str(dat)
dat$읍면동 = as.character(dat$읍면동)
loc = dat$읍면동
#loc
dangha = grep('당하동', loc)
wondang = grep('원당동', loc)
bulo = grep('불로대곡동' , loc)
songdo=grep('송도동', loc)
eunseo=grep('운서동', loc)
youngjong=grep('영종동',loc)
dohwa=grep('도화동',loc)
soongee=grep('숭의동',loc)
chungla=grep('청라동', loc)
suknam=grep('석남동',loc)
gaza=grep('가좌동',loc)
gajung=grep('가정동',loc)
gumdan=grep('검단동',loc)
bupyeong=grep('부평동',loc)
hwasu = grep('화수동', loc)
songlim=grep('송림동',loc)
dat[dangha,]$개발호재유무 =  1
dat[wondang,]$개발호재유무 = 1
dat[bulo,]$개발호재유무 = 1
dat[songdo,]$개발호재유무 = 1
dat[hwasu,]$개발호재유무 = 1
dat[songlim,]$개발호재유무 = 1
dat[eunseo,]$개발호재유무 = 1
dat[youngjong,]$개발호재유무 = 1
dat[dohwa,]$개발호재유무 = 1
dat[soongee,]$개발호재유무 = 1
dat[chungla,]$개발호재유무 =1
dat[suknam,]$개발호재유무 = 1
dat[gaza,]$개발호재유무 = 1
dat[gajung,]$개발호재유무 =1
dat[gumdan,]$개발호재유무 =1
dat[bupyeong,]$개발호재유무 = 1
dat[hwasu,]$개발호재유무 = 1
dat[songlim,]$개발호재유무 = 1
write.csv(dat,'단지별변수(추가).csv')
is.na(dat$개밣개발호재유무)
dat$개밣개발호재유무
is.na(dat$개발호재유무)
dat[is.na(dat$개발호재유무)]<-0
dat[is.na(dat$개발호재유무)]<-0
dat[,is.na(dat$개발호재유무)]<-0
dat[is.na(dat$개발호재유무)]<-0
?which
which(is.na(dat$개발호재유무))
dat[which(is.na(dat$개발호재유무)),dat$개발호재유무]<-0
dat[which(is.na(dat$개발호재유무)),]$개발호재유무<-0
View(dat)
write.csv(dat,'단지별변수(추가).csv')
write.csv(dat,'단지별변수(추가).csv')
setwd("C:\\Users\\user\\Desktop\\Project_apartment")
#####################333333333333333333333333333333333
Adat<-read.csv("단지별변수(추가).csv",header=T)
head(Adat)
y<-Adat$매매평균..당가.만원.
#####################333333333333333333333333333333333
dat<-read.csv("단지별변수(추가).csv",header=T)
y<-dat$매매평균..당가.만원.
MA<-dat
MA<-dat$혼인건수3년평균
plot(MA,y)
y<-dat$X3년.평균.인구수
MA<-dat$혼인건수3년평균
y<-dat$X3년.평균.인구수
MA<-dat$혼인건수3년평균
plot(MA,y)
y<-dat$역세권점수
MA<-dat$혼인건수3년평균
plot(MA,y)
y<-dat$X3년.평균.인구수
y<-dat$X3년.평균.인구수
Pop<-dat$X3년.평균.인구수
MA<-dat$혼인건수3년평균
plot(MA,y)
plot(Pop,MA)
## set working directory
setwd("C:\\Users\\user\\Desktop\\Project_apartment\\시계열 데이터")
## Load csv file
dat = read.csv('Marriage.csv',header=T,stringsAsFactors=F)
plot(MA,Pop)
plot(MA)
#####################333333333333333333333333333333333
dat<-read.csv("단지별변수(추가).csv",header=T)
setwd("C:\\Users\\user\\Desktop\\Project_apartment")
#####################333333333333333333333333333333333
dat<-read.csv("단지별변수(추가).csv",header=T)
Dep<-dat$개발호재유무
Dep<-dat$개발호재유무
Dep<-dat$개발호재유무
trans<-dat$역세권점수
Dep<-dat$개발호재유무
trans<-dat$역세권점수
plot(Dep,trans)
Dep<-dat$개발호재유무
y<-dat$매매평균..당가.만원.
plot(Dep,y)
setwd("C:\\Users\\user\\Desktop\\Project_apartment")
#####################333333333333333333333333333333333
dat<-read.csv("단지별변수(추가).csv",header=T)
plot(x=dat$지가변동률.누계,y=dat$매매평균..당가.만원.)
dat["지가변동률.누계"].describe()
dat$지가변동률.누계.describe()
dat.describe()
boxplot(dat$지가변동률.누계)
(boxstats<-boxplot(dat$지가변동률.누계))
plot(MA)
plot(x=dat$개발호재유무,y=dat$매매평균..당가.만원.)
barplot(dat$개발호재유무)
plot(dat$개발호재유무)
plot(x=dat$개발호재유무,y=dat$매매평균..당가.만원.)
dep<-table(dat$개발호재유무)
dep<-table(dat$혼인건수3년평균)
barplot(dep)
barplot(dep,main="Marriage",xlab="Number of Marriage")
hist(dat$혼인건수3년평균)
hist(dat$지가변동률.누계)
dat2<-read.csv("기준금리.csv",head=F)
hist(dat2)
dat2<-read.csv("기준금리.csv",header=F)
setwd("C:\\Users\\user\\Desktop\\Project_apartment")
dat2<-read.csv("기준금리.csv",header=F)
setwd("C:\\Users\\user\\Desktop\\Project_apartment\\시계열데이터")
dat2<-read.csv("기준금리.csv",header=F)
setwd("C:\\Users\\user\\Desktop\\Project_apartment\\시계열데이터")
setwd("C:\\Users\\user\\Desktop\\Project_apartment\\시계열데이터")
setwd("C:\\Users\\user\\Desktop\\Project_apartment")
setwd("C:\\Users\\user\\Desktop\\Project_apartment\\시계열 데이터")
dat2<-read.csv("기준금리.csv",header=F)
hist(dat2)
hist(dat2$)
hist(dat2$V3)
hist(dat2$V3,xlab="기준금리")
plot(x=dat$토지면적.km2.,y=dat$매매평균..당가.만원.)
(boxstats<-boxplot(dat$토지면적.km2.))
qqnorm(dat$혼인건수3년평균)
qqnorm(dat$지가변동률.누계)
